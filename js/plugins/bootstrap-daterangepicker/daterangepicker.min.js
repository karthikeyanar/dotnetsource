/*
: Copyright (c) 2012-2013 Dan Grossman. All rights reserved.
 @license: Licensed under Apache License v2.0. See http://www.apache.org/licenses/LICENSE-2.0
 @website: http://www.improvely.com/
*/
!function(e){var l=function(a,b,d){var f="object"==typeof b,c;this.startDate=moment().startOf("day");this.endDate=moment().startOf("day");this.timePicker=this.showWeekNumbers=this.showDropdowns=this.dateLimit=this.maxDate=this.minDate=!1;this.timePickerIncrement=30;this.timePicker12Hour=!0;this.ranges={};this.opens="right";this.buttonClasses=["btn","btn-small"];this.applyClass="btn-success";this.cancelClass="btn-default";this.format="MM/DD/YYYY";this.separator=" - ";this.locale={applyLabel:"Apply",
cancelLabel:"Cancel",fromLabel:"From",toLabel:"To",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:moment()._lang._weekdaysMin.slice(),monthNames:moment()._lang._monthsShort.slice(),firstDay:0};this.cb=function(){};this.parentEl="body";this.element=e(a);this.element.hasClass("pull-right")&&(this.opens="left");if(this.element.is("input"))this.element.on({click:e.proxy(this.show,this),focus:e.proxy(this.show,this)});else this.element.on("click",e.proxy(this.show,this));c=this.locale;f&&("object"==
typeof b.locale&&e.each(c,function(a,d){c[a]=b.locale[a]||d}),b.applyClass&&(this.applyClass=b.applyClass),b.cancelClass&&(this.cancelClass=b.cancelClass));a='<div class="daterangepicker dropdown-menu"><div class="calendar left"></div><div class="calendar right"></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input"><label for="daterangepicker_start">'+this.locale.fromLabel+'</label><input class="form-control" type="text" name="daterangepicker_start" value="" disabled="disabled" /></div><div class="daterangepicker_end_input"><label for="daterangepicker_end">'+
this.locale.toLabel+'</label><input class="form-control" type="text" name="daterangepicker_end" value="" disabled="disabled" /></div><button class="'+this.applyClass+' applyBtn margin-right-10" disabled="disabled">'+this.locale.applyLabel+'</button>&nbsp;<button class="'+this.cancelClass+' cancelBtn">'+this.locale.cancelLabel+"</button></div></div></div>";this.parentEl=f&&b.parentEl&&e(b.parentEl)||e(this.parentEl);this.container=e(a).appendTo(this.parentEl);if(f){"string"==typeof b.format&&(this.format=
b.format);"string"==typeof b.separator&&(this.separator=b.separator);"string"==typeof b.startDate&&(this.startDate=moment(b.startDate,this.format));"string"==typeof b.endDate&&(this.endDate=moment(b.endDate,this.format));"string"==typeof b.minDate&&(this.minDate=moment(b.minDate,this.format));"string"==typeof b.maxDate&&(this.maxDate=moment(b.maxDate,this.format));"object"==typeof b.startDate&&(this.startDate=moment(b.startDate));"object"==typeof b.endDate&&(this.endDate=moment(b.endDate));"object"==
typeof b.minDate&&(this.minDate=moment(b.minDate));"object"==typeof b.maxDate&&(this.maxDate=moment(b.maxDate));if("object"==typeof b.ranges){for(var g in b.ranges){var k=moment(b.ranges[g][0]),h=moment(b.ranges[g][1]);this.minDate&&k.isBefore(this.minDate)&&(k=moment(this.minDate));this.maxDate&&h.isAfter(this.maxDate)&&(h=moment(this.maxDate));this.minDate&&h.isBefore(this.minDate)||this.maxDate&&k.isAfter(this.maxDate)||(this.ranges[g]=[k,h])}a="<ul>";for(g in this.ranges)a+="<li>"+g+"</li>";a+=
"<li>"+this.locale.customRangeLabel+"</li>";a+="</ul>";this.container.find(".ranges").prepend(a)}"object"==typeof b.dateLimit&&(this.dateLimit=b.dateLimit);if("object"==typeof b.locale&&("object"==typeof b.locale.daysOfWeek&&(this.locale.daysOfWeek=b.locale.daysOfWeek.slice()),"number"==typeof b.locale.firstDay))for(g=this.locale.firstDay=b.locale.firstDay;0<g;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),g--;"string"==typeof b.opens&&(this.opens=b.opens);"boolean"==typeof b.showWeekNumbers&&
(this.showWeekNumbers=b.showWeekNumbers);"string"==typeof b.buttonClasses&&(this.buttonClasses=[b.buttonClasses]);"object"==typeof b.buttonClasses&&(this.buttonClasses=b.buttonClasses);"boolean"==typeof b.showDropdowns&&(this.showDropdowns=b.showDropdowns);"boolean"==typeof b.timePicker&&(this.timePicker=b.timePicker);"number"==typeof b.timePickerIncrement&&(this.timePickerIncrement=b.timePickerIncrement);"boolean"==typeof b.timePicker12Hour&&(this.timePicker12Hour=b.timePicker12Hour)}this.timePicker||
(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.startOf("day"));var l=this.container;e.each(this.buttonClasses,function(a,b){l.find("button").addClass(b)});"right"==this.opens&&(g=this.container.find(".calendar.left"),a=this.container.find(".calendar.right"),g.removeClass("left").addClass("right"),a.removeClass("right").addClass("left"));if("undefined"==typeof b||"undefined"==typeof b.ranges)this.container.find(".calendar").show(),this.move();"function"==typeof d&&(this.cb=
d);this.container.addClass("opens"+this.opens);(!f||"undefined"==typeof b.startDate&&"undefined"==typeof b.endDate)&&e(this.element).is("input[type=text]")&&(d=e(this.element).val().split(this.separator),2==d.length&&(k=moment(d[0],this.format),h=moment(d[1],this.format)),null!=k&&null!=h&&(this.startDate=k,this.endDate=h));this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();this.leftCalendar={month:moment([this.startDate.year(),this.startDate.month(),1,this.startDate.hour(),
this.startDate.minute()]),calendar:[]};this.rightCalendar={month:moment([this.endDate.year(),this.endDate.month(),1,this.endDate.hour(),this.endDate.minute()]),calendar:[]};this.container.on("mousedown",e.proxy(this.mousedown,this));this.container.find(".calendar").on("click",".prev",e.proxy(this.clickPrev,this)).on("click",".next",e.proxy(this.clickNext,this)).on("click","td.available",e.proxy(this.clickDate,this)).on("mouseenter","td.available",e.proxy(this.enterDate,this)).on("mouseleave","td.available",
e.proxy(this.updateFormInputs,this)).on("change","select.yearselect",e.proxy(this.updateMonthYear,this)).on("change","select.monthselect",e.proxy(this.updateMonthYear,this)).on("change","select.hourselect,select.minuteselect,select.ampmselect",e.proxy(this.updateTime,this));this.container.find(".ranges").on("click","button.applyBtn",e.proxy(this.clickApply,this)).on("click","button.cancelBtn",e.proxy(this.clickCancel,this)).on("click",".daterangepicker_start_input,.daterangepicker_end_input",e.proxy(this.showCalendars,
this)).on("click","li",e.proxy(this.clickRange,this)).on("mouseenter","li",e.proxy(this.enterRange,this)).on("mouseleave","li",e.proxy(this.updateFormInputs,this));this.element.on("keyup",e.proxy(this.updateFromControl,this));this.updateView();this.updateCalendars()};l.prototype={constructor:l,mousedown:function(a){a.stopPropagation()},updateView:function(){this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year());
this.updateFormInputs()},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.format));this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.format));this.startDate.isSame(this.endDate)||this.startDate.isBefore(this.endDate)?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled")},updateFromControl:function(){if(this.element.is("input")&&
this.element.val().length){var a=this.element.val().split(this.separator),b=moment(a[0],this.format),a=moment(a[1],this.format);null==b||null==a||a.isBefore(b)||(this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.startDate=b,this.endDate=a,this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.notify(),this.updateCalendars())}},notify:function(){this.updateView();this.cb(this.startDate,this.endDate)},move:function(){var a=this.parentEl.offset().left-
(this.parentEl.is("body")?0:this.parentEl.scrollLeft());"left"==this.opens?(this.container.css({top:this.element.offset().top+this.element.outerHeight()-0,right:e(window).width()-this.element.offset().left-this.element.outerWidth()-a,left:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):(this.container.css({top:this.element.offset().top+this.element.outerHeight()-0,left:this.element.offset().left-a,right:"auto"}),this.container.offset().left+this.container.outerWidth()>
e(window).width()&&this.container.css({left:"auto",right:0}))},show:function(a){this.container.show();this.move();a&&(a.stopPropagation(),a.preventDefault());e(document).on("mousedown",e.proxy(this.hide,this));this.element.trigger("shown",{target:a.target,picker:this})},hide:function(a){this.container.hide();this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.notify();this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();e(document).off("mousedown",
this.hide);this.element.trigger("hidden",{picker:this})},enterRange:function(a){a=a.target.innerHTML;a==this.locale.customRangeLabel?this.updateView():(a=this.ranges[a],this.container.find("input[name=daterangepicker_start]").val(a[0].format(this.format)),this.container.find("input[name=daterangepicker_end]").val(a[1].format(this.format)))},showCalendars:function(){this.container.find(".calendar").show();this.move()},updateInputText:function(){this.element.is("input")&&this.element.val(this.startDate.format(this.format)+
this.separator+this.endDate.format(this.format))},clickRange:function(a){a=a.target.innerHTML;a==this.locale.customRangeLabel?this.showCalendars():(a=this.ranges[a],this.startDate=a[0],this.endDate=a[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.startOf("day")),this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year()).hour(this.startDate.hour()).minute(this.startDate.minute()),this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year()).hour(this.endDate.hour()).minute(this.endDate.minute()),
this.updateCalendars(),this.updateInputText(),this.container.find(".calendar").hide(),this.hide())},clickPrev:function(a){e(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.subtract("month",1):this.rightCalendar.month.subtract("month",1);this.updateCalendars()},clickNext:function(a){e(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add("month",1):this.rightCalendar.month.add("month",1);this.updateCalendars()},enterDate:function(a){var b=e(a.target).attr("data-title"),
d=b.substr(1,1),b=b.substr(3,1);e(a.target).parents(".calendar").hasClass("left")?this.container.find("input[name=daterangepicker_start]").val(this.leftCalendar.calendar[d][b].format(this.format)):this.container.find("input[name=daterangepicker_end]").val(this.rightCalendar.calendar[d][b].format(this.format))},clickDate:function(a){var b=e(a.target).attr("data-title"),d=b.substr(1,1),f=b.substr(3,1),b=e(a.target).parents(".calendar");if(b.hasClass("left")){var c=this.leftCalendar.calendar[d][f],d=
this.endDate;"object"==typeof this.dateLimit&&(f=moment(c).add(this.dateLimit).startOf("day"),d.isAfter(f)&&(d=f))}else c=this.startDate,d=this.rightCalendar.calendar[d][f],"object"==typeof this.dateLimit&&(f=moment(d).subtract(this.dateLimit).startOf("day"),c.isBefore(f)&&(c=f));b.find("td").removeClass("active");c.isSame(d)||c.isBefore(d)?(e(a.target).addClass("active"),this.startDate=c,this.endDate=d):c.isAfter(d)&&(e(a.target).addClass("active"),this.startDate=c,this.endDate=moment(c).add("day",
1).startOf("day"));this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year());this.updateCalendars()},clickApply:function(a){this.updateInputText();this.hide()},clickCancel:function(a){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.updateView();this.updateCalendars();this.hide()},updateMonthYear:function(a){a=e(a.target).closest(".calendar").hasClass("left");var b=this.container.find(".calendar.left");
a||(b=this.container.find(".calendar.right"));var d=parseInt(b.find(".monthselect").val(),10),b=b.find(".yearselect").val();a?this.leftCalendar.month.month(d).year(b):this.rightCalendar.month.month(d).year(b);this.updateCalendars()},updateTime:function(a){var b=e(a.target).closest(".calendar").hasClass("left"),d=this.container.find(".calendar.left");b||(d=this.container.find(".calendar.right"));a=parseInt(d.find(".hourselect").val());var f=parseInt(d.find(".minuteselect").val());this.timePicker12Hour&&
(d=d.find(".ampmselect").val(),"PM"==d&&12>a&&(a+=12),"AM"==d&&12==a&&(a=0));b?(b=this.startDate.clone(),b.hour(a),b.minute(f),this.startDate=b,this.leftCalendar.month.hour(a).minute(f)):(b=this.endDate.clone(),b.hour(a),b.minute(f),this.endDate=b,this.rightCalendar.month.hour(a).minute(f));this.updateCalendars()},updateCalendars:function(){this.leftCalendar.calendar=this.buildCalendar(this.leftCalendar.month.month(),this.leftCalendar.month.year(),this.leftCalendar.month.hour(),this.leftCalendar.month.minute(),
"left");this.rightCalendar.calendar=this.buildCalendar(this.rightCalendar.month.month(),this.rightCalendar.month.year(),this.rightCalendar.month.hour(),this.rightCalendar.month.minute(),"right");this.container.find(".calendar.left").html(this.renderCalendar(this.leftCalendar.calendar,this.startDate,this.minDate,this.maxDate));this.container.find(".calendar.right").html(this.renderCalendar(this.rightCalendar.calendar,this.endDate,this.startDate,this.maxDate));this.container.find(".ranges li").removeClass("active");
var a=!0,b=0,d;for(d in this.ranges)this.timePicker?this.startDate.isSame(this.ranges[d][0])&&this.endDate.isSame(this.ranges[d][1])&&(a=!1,this.container.find(".ranges li:eq("+b+")").addClass("active")):this.startDate.format("YYYY-MM-DD")==this.ranges[d][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[d][1].format("YYYY-MM-DD")&&(a=!1,this.container.find(".ranges li:eq("+b+")").addClass("active")),b++;a&&this.container.find(".ranges li:last").addClass("active")},buildCalendar:function(a,
b,d,f,c){a=moment([b,a,1]);c=moment(a).subtract("month",1).month();var e=moment(a).subtract("month",1).year(),k=moment([e,c]).daysInMonth(),h=a.day();a=[];for(b=0;6>b;b++)a[b]=[];b=k-h+this.locale.firstDay+1;b>k&&(b-=7);h==this.locale.firstDay&&(b=k-6);f=moment([e,c,b,12,f]);for(e=c=b=0;42>b;b++,c++,f=moment(f).add("hour",24))0<b&&0==c%7&&(c=0,e++),a[e][c]=f.clone().hour(d),f.hour(12);return a},renderDropdowns:function(a,b,d){for(var f=a.month(),c='<select class="monthselect">',e=0;12>e;e++)c+="<option value='"+
e+"'"+(e===f?" selected='selected'":"")+">"+this.locale.monthNames[e]+"</option>";c+="</select>";a=a.year();d=d&&d.year()||a+5;f='<select class="yearselect">';for(b=b&&b.year()||a-50;b<=d;b++)f+='<option value="'+b+'"'+(b===a?' selected="selected"':"")+">"+b+"</option>";return c+(f+"</select>")},renderCalendar:function(a,b,d,f){var c='<div class="calendar-date">',c=c+'<table class="table-condensed">',c=c+"<thead>",c=c+"<tr>";this.showWeekNumbers&&(c+="<th></th>");var c=!d||d.isBefore(a[1][1])?c+'<th class="prev available"><i class="fa fa-arrow-left icon-arrow-left glyphicon glyphicon-arrow-left"></i></th>':
c+"<th></th>",g=this.locale.monthNames[a[1][1].month()]+a[1][1].format(" YYYY");this.showDropdowns&&(g=this.renderDropdowns(a[1][1],d,f));c+='<th colspan="5" style="width: auto">'+g+"</th>";c=!f||f.isAfter(a[1][1])?c+'<th class="next available"><i class="fa fa-arrow-right icon-arrow-right glyphicon glyphicon-arrow-right"></i></th>':c+"<th></th>";c+="</tr>";c+="<tr>";this.showWeekNumbers&&(c+='<th class="week">'+this.locale.weekLabel+"</th>");e.each(this.locale.daysOfWeek,function(a,b){c+="<th>"+b+
"</th>"});c+="</tr>";c+="</thead>";c+="<tbody>";for(g=0;6>g;g++){c+="<tr>";this.showWeekNumbers&&(c+='<td class="week">'+a[g][0].week()+"</td>");for(var k=0;7>k;k++){var h="available ",h=h+(a[g][k].month()==a[1][1].month()?"":"off");d&&a[g][k].isBefore(d)||f&&a[g][k].isAfter(f)?h=" off disabled ":a[g][k].format("YYYY-MM-DD")==b.format("YYYY-MM-DD")?(h+=" active ",a[g][k].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&(h+=" start-date "),a[g][k].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&
(h+=" end-date ")):a[g][k]>=this.startDate&&a[g][k]<=this.endDate&&(h+=" in-range ",a[g][k].isSame(this.startDate)&&(h+=" start-date "),a[g][k].isSame(this.endDate)&&(h+=" end-date "));var l="r"+g+"c"+k,c=c+('<td class="'+h.replace(/\s+/g," ").replace(/^\s?(.*?)\s?$/,"$1")+'" data-title="'+l+'">'+a[g][k].date()+"</td>")}c+="</tr>"}c+="</tbody>";c+="</table>";c+="</div>";if(this.timePicker){c+='<div class="calendar-time">';c+='<select class="hourselect">';f=0;a=23;d=b.hour();this.timePicker12Hour&&
(f=1,a=12,12<=d&&(d-=12),0==d&&(d=12));for(;f<=a;f++)c=f==d?c+('<option value="'+f+'" selected="selected">'+f+"</option>"):c+('<option value="'+f+'">'+f+"</option>");c+="</select> : ";c+='<select class="minuteselect">';for(f=0;60>f;f+=this.timePickerIncrement)a=f,10>a&&(a="0"+a),c=f==b.minute()?c+('<option value="'+f+'" selected="selected">'+a+"</option>"):c+('<option value="'+f+'">'+a+"</option>");c+="</select> ";this.timePicker12Hour&&(c+='<select class="ampmselect">',c=12<=b.hour()?c+'<option value="AM">AM</option><option value="PM" selected="selected">PM</option>':
c+'<option value="AM" selected="selected">AM</option><option value="PM">PM</option>',c+="</select>");c+="</div>"}return c}};e.fn.daterangepicker=function(a,b){this.each(function(){var d=e(this);d.data("daterangepicker")||d.data("daterangepicker",new l(d,a,b))});return this}}(window.jQuery);
