(function(f){f.fn.TouchSpin=function(A){var B={min:0,max:100,initval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default"};return this.each(function(){var l,m,k;function C(){var a=d.val(),u=d.parent();""!==a&&(a=Number(a).toFixed(b.decimals));d.data("initvalue",a).val(a);d.addClass("form-control");
f("<style type='text/css'>.bootstrap-touchspin-prefix:empty,.bootstrap-touchspin-postfix:empty{display:none;}</style>").appendTo("head");if(u.hasClass("input-group")){u.addClass("bootstrap-touchspin");var c=d.prev(),a=d.next(),e,g='<span class="input-group-addon bootstrap-touchspin-prefix">'+b.prefix+"</span>",k='<span class="input-group-addon bootstrap-touchspin-postfix">'+b.postfix+"</span>";c.hasClass("input-group-btn")?(e='<button class="'+b.buttondown_class+' bootstrap-touchspin-down" type="button">-</button>',
c.append(e)):(e='<span class="input-group-btn"><button class="'+b.buttondown_class+' bootstrap-touchspin-down" type="button">-</button></span>',f(e).insertBefore(d));a.hasClass("input-group-btn")?(c='<button class="'+b.buttonup_class+' bootstrap-touchspin-up" type="button">+</button>',a.prepend(c)):(c='<span class="input-group-btn"><button class="'+b.buttonup_class+' bootstrap-touchspin-up" type="button">+</button></span>',f(c).insertAfter(d));f(g).insertBefore(d);f(k).insertAfter(d);h=u}else h=f('<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+
b.buttondown_class+' bootstrap-touchspin-down" type="button">-</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+b.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+b.postfix+'</span><span class="input-group-btn"><button class="'+b.buttonup_class+' bootstrap-touchspin-up" type="button">+</button></span></div>').insertBefore(d),f(".bootstrap-touchspin-prefix",h).after(d),d.hasClass("input-sm")?h.addClass("input-group-sm"):d.hasClass("input-lg")&&
h.addClass("input-group-lg")}function D(){d.on("keydown",function(a){var b=a.keyCode||a.which;38===b?("up"!==g&&(n(),s()),a.preventDefault()):40===b&&("down"!==g&&(p(),t()),a.preventDefault())});d.on("keyup",function(a){a=a.keyCode||a.which;38===a?e():40===a&&e()});d.on("blur",function(){r()});l.on("keydown",function(a){var b=a.keyCode||a.which;if(32===b||13===b)"down"!==g&&(p(),t()),a.preventDefault()});l.on("keyup",function(a){a=a.keyCode||a.which;32!==a&&13!==a||e()});m.on("keydown",function(a){var b=
a.keyCode||a.which;if(32===b||13===b)"up"!==g&&(n(),s()),a.preventDefault()});m.on("keyup",function(a){a=a.keyCode||a.which;32!==a&&13!==a||e()});l.on("mousedown touchstart",function(a){p();t();a.preventDefault();a.stopPropagation()});m.on("mousedown touchstart",function(a){n();s();a.preventDefault();a.stopPropagation()});m.on("mouseout touchleave touchend touchcancel",function(a){g&&(a.stopPropagation(),e())});l.on("mouseout touchleave touchend touchcancel",function(a){g&&(a.stopPropagation(),e())});
l.on("mousemove touchmove",function(a){g&&(a.stopPropagation(),a.preventDefault())});m.on("mousemove touchmove",function(a){g&&(a.stopPropagation(),a.preventDefault())});f(document).on("mouseup touchend touchcancel",function(a){g&&(a.preventDefault(),e())});f(document).on("mousemove touchmove scroll scrollstart",function(a){g&&(a.preventDefault(),e())});if(b.mousewheel)d.on("mousewheel DOMMouseScroll",function(a){var b=a.originalEvent.wheelDelta||-a.originalEvent.detail;a.stopPropagation();a.preventDefault();
0>b?p():n()})}function E(){d.on("touchspin.uponce",function(){e();n()});d.on("touchspin.downonce",function(){e();p()});d.on("touchspin.startupspin",function(){s()});d.on("touchspin.startdownspin",function(){t()});d.on("touchspin.stopspin",function(){e()});d.on("touchspin.updatesettings",function(a,d){b=f.extend({},b,d);r();var c=Number(k.val());k.val(c.toFixed(b.decimals))})}function F(a){switch(b.forcestepdivisibility){case "round":return(Math.round(a/b.step)*b.step).toFixed(b.decimals);case "floor":return(Math.floor(a/
b.step)*b.step).toFixed(b.decimals);case "ceil":return(Math.ceil(a/b.step)*b.step).toFixed(b.decimals);default:return a}}function r(){var a,c,e;a=d.val();""===a||0<b.decimals&&"."===a||(c=parseFloat(a),isNaN(c)&&(c=0),e=c,c.toString()!==a&&(e=c),c<b.min&&(e=b.min),c>b.max&&(e=b.max),e=F(e),Number(a).toString()!==e.toString()&&(d.val(e),d.trigger("change")))}function v(){if(b.booster){var a=Math.pow(2,Math.floor(q/b.boostat))*b.step;b.maxboostedstep&&a>b.maxboostedstep&&(a=b.maxboostedstep,c=Math.round(c/
a*a));return Math.max(b.step,a)}return b.step}function n(){r();c=parseFloat(k.val());isNaN(c)&&(c=0);var a=c,f=v();c+=f;c>b.max&&(e(),c=b.max,d.trigger("touchspin.max"));k.val(Number(c).toFixed(b.decimals));a!==c&&d.trigger("change")}function p(){r();c=parseFloat(k.val());isNaN(c)&&(c=0);var a=c,f=v();c-=f;c<b.min&&(e(),c=b.min,d.trigger("touchspin.min"));k.val(c.toFixed(b.decimals));a!==c&&d.trigger("change")}function t(){e();q=0;g="down";w=setTimeout(function(){x=setInterval(function(){q++;p()},
b.stepinterval)},b.stepintervaldelay)}function s(){e();q=0;g="up";y=setTimeout(function(){z=setInterval(function(){q++;n()},b.stepinterval)},b.stepintervaldelay)}function e(){clearTimeout(w);clearTimeout(y);clearInterval(x);clearInterval(z);q=0;g=!1}var b,d=f(this),G=d.data(),h,c,x,z,w,y,q=0,g=!1;d.data("alreadyinitialized")||(d.data("alreadyinitialized",!0),d.is("input")?(b=f.extend({},B,G,A),""!==b.initval&&""===d.val()&&d.val(b.initval),r(),C(),l=f(".bootstrap-touchspin-down",h),m=f(".bootstrap-touchspin-up",
h),k=f("input",h),f(".bootstrap-touchspin-prefix",h).addClass(b.prefix_extraclass),f(".bootstrap-touchspin-postfix",h).addClass(b.postfix_extraclass),D(),E()):console.log("Must be an input."))})}})(jQuery);
